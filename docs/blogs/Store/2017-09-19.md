---
title: XSS初识
date: 2017-09-19
tags: 
  - 安全
categories: 
  - JavaScript
---

XSS攻击与防范

<!-- more -->

## 攻击方式

### 反射型

通过URL输入提交到服务器端，待解析响应后，返回到浏览器，并解析执行XSS代码的行为。

例子（常见于插入广告后再进行传播）：

```javascript
//在地址后添加攻击性代码后传播
/?xss=<p onclick="alert(1)">
```

### 存储型

 上面的不影响服务端，但存储型会影响服务端（存在文件系统、数据库等地方），下次请求时页面不用再次提交XSS代码。

## 防范措施

### 编码

对用户输入的数据进行HTML Entity编码。

|  字符   |  十进制   |  转义字符   |
| --- | --- | --- |
|  “   |  &#34 ;   |  &quot ;   |
|  &   |  &#38 ;  |  &amp ;   |
|  <   |  &#60 ;   |  &lt ;   |
|  >   |  &#62 ;   |  &gt ;   |
|  不断开空格（\s）   |  &#160 ;   |  &nbsp ;   |

使用replace来替换上面的这些字符，使得不影响结果。

### 过滤

删除用户上传的不安全的内容，包括DOM属性，如onerror等事件，或是Style节点、Script节点、Iframe节点等。

直接使用JavaScript来筛选上传的数据即可。

### 校正

避免直接对HTML Entity解码，使用DOM Parse转换，校正不配对的DOM标签。
